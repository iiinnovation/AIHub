# AIHub

一个强大的桌面应用，用于在单一窗口内管理多个 AI 聊天平台，**专为 Windows 优化，特别增强了对国内 AI 平台的支持**。

![平台](https://img.shields.io/badge/平台-Windows-blue)
![Electron](https://img.shields.io/badge/Electron-28.0-47848F)
![许可证](https://img.shields.io/badge/许可证-MIT-green)
![版本](https://img.shields.io/badge/版本-1.1.0-brightgreen)

## ✨ 功能特性

- **🔄 多 AI 平台切换**：支持 ChatGPT、Claude、Gemini、**通义千问**、**DeepSeek**、**豆包**
- **📤 对话提取**：一键提取当前对话内容，智能识别用户和 AI 消息
- **📥 上下文导入**：将文本快速注入到 AI 输入框，自动激活发送按钮
- **🗜️ 上下文压缩**：生成压缩提示词（25%/50%/75%），帮助总结长对话
- **📋 提示词模板**：创建、编辑、导入/导出常用提示词模板，支持 `{clipboard}` 变量替换
- **💾 独立会话管理**：每个平台的登录状态和对话历史独立保存
- **🚀 Windows 优化**：针对 Windows 系统特别优化，提升稳定性和兼容性

## 🆕 最新更新 (v1.1.0)

### Windows 兼容性增强
- ✅ 修复了 Windows 系统下提取内容返回 `undefined` 的问题
- ✅ 改进字符转义处理，完美支持换行符和特殊字符
- ✅ 增强错误提示，提供更友好的故障排除信息
- ✅ 优化页面加载等待机制，减少操作失败率

### 国内 AI 平台优化（重点）
- 🇨🇳 **豆包（Doubao）**：全新提取算法，支持多种页面布局
- 🇨🇳 **DeepSeek**：优化消息识别，过滤 UI 元素干扰
- 🇨🇳 **通义千问（Qwen）**：增强角色判断，提升提取准确性
- 🎯 国内平台输入框优先匹配，提升导入成功率
- 🔧 修复了"Qwen 可以但豆包、DeepSeek 不行"的问题

### 核心功能改进
- 📊 智能去重机制，避免重复消息
- 🎨 改进内容提取，自动排除按钮和工具栏
- ⚡ 优化事件触发机制，确保发送按钮正确激活
- 🛡️ 增强降级方案，提高容错能力

## 截图

```
┌─────────────────────────────────────────────────────┐
│  AIHub                                              │
├──────────┬──────────────────────────────────────────┤
│ 🟢 ChatGPT │                                        │
│ 🟠 Claude  │         AI 聊天界面                     │
│ 🔵 Gemini  │                                        │
│ 🟣 通义千问 │                                        │
│ ⚫ DeepSeek│                                        │
│ 🟤 豆包    │                                        │
├──────────┴──────────────────────────────────────────┤
│  [提取]  [导入]  [压缩]  [模板]                      │
└─────────────────────────────────────────────────────┘
```

## 安装

### 方式一：下载安装包（推荐）

前往 [Releases](../../releases) 页面下载最新的 `.exe` 安装包。

### 方式二：从源码运行

```bash
# 克隆仓库
git clone https://github.com/你的用户名/AIHub-Windows.git
cd AIHub-Windows

# 安装依赖
npm install

# 运行应用
npm start
```

## 打包构建

### 在 Windows 上打包

```bash
npm run build:win
```

构建完成后，安装包在 `dist/` 目录下。

### 使用 GitHub Actions 自动打包

推送代码到 GitHub 后，会自动触发构建流程，生成的安装包可在 Actions 的 Artifacts 中下载。

## 📖 使用说明

### 1️⃣ 切换 AI 平台

点击左侧边栏的 AI 名称即可切换（支持国内外 6 大平台）：

- 🟢 **ChatGPT** - OpenAI 官方聊天
- 🟠 **Claude** - Anthropic 的 Claude
- 🔵 **Gemini** - Google 的 Gemini
- 🟣 **通义千问** - 阿里巴巴大模型
- ⚫ **DeepSeek** - 国产深度求索
- 🟤 **豆包** - 字节跳动 AI 助手

**提示**：每个平台的登录状态会独立保存，切换后无需重复登录。

### 2️⃣ 提取对话

**适用场景**：保存重要对话、备份聊天记录、迁移到其他平台

1. 在 AI 平台进行对话
2. 点击底部 **「提取」** 按钮
3. 对话内容会以标准格式显示在弹窗中：
   ```
   [USER]
   你好，请介绍一下人工智能

   ---

   [ASSISTANT]
   人工智能（AI）是...
   ```
4. 点击 **「复制到剪贴板」** 保存

**注意**：
- ✅ 确保页面已完全加载且有对话内容
- ✅ 支持长对话自动滚动提取
- ⚠️ 如果提取失败，请尝试刷新页面后重试

### 3️⃣ 导入上下文

**适用场景**：快速注入长文本、粘贴代码、导入文档内容

1. 点击底部 **「导入」** 按钮
2. 在文本框中粘贴要导入的内容
3. 点击 **「导入」**，文本会自动填入 AI 输入框
4. 发送按钮会自动激活，可直接发送

**支持的内容**：
- 📝 长文本（支持换行、特殊字符）
- 💻 代码片段（保留格式）
- 📄 文档内容（自动转义）

**Windows 优化**：新版本增强了字符转义，完美支持中文和特殊符号。

### 4️⃣ 压缩上下文

**适用场景**：对话太长超出限制、需要总结要点、切换到新对话

1. 在有对话内容时，点击 **「压缩」** 按钮
2. 选择压缩比例：
   - **25%** - 极简摘要（适合快速了解）
   - **50%** - 平衡摘要（推荐）
   - **75%** - 详细摘要（保留更多细节）
3. 点击 **「生成提示词」**
4. 压缩提示词自动复制到剪贴板
5. 粘贴到**新对话**中，AI 会自动总结并返回压缩后的内容

**输出示例**：
```json
{
  "compressed": "讨论了人工智能的发展历程，从图灵测试到深度学习...",
  "keyPoints": [
    "AI 起源于 1950 年代",
    "深度学习是当前主流技术",
    "应用领域包括..."
  ]
}
```

### 5️⃣ 提示词模板

**适用场景**：常用指令、固定格式、批量处理

#### 创建模板
1. 点击 **「模板」** 按钮打开模板管理
2. 点击 **「+ 新建」** 创建模板
3. 填写模板名称和内容
4. 内容支持 `{clipboard}` 变量（使用时会自动替换为剪贴板内容）
5. 点击 **「保存」**

#### 使用模板
1. 打开模板管理
2. 点击模板旁的 **✓** 按钮
3. 内容会自动填充到 AI 输入框

#### 模板示例

**翻译助手**
```
请将以下内容翻译为英文，保持专业性和准确性：

{clipboard}
```

**代码审查**
```
请审查以下代码，指出潜在问题和改进建议：

{clipboard}

关注点：
- 性能优化
- 安全漏洞
- 代码规范
```

**文档总结**
```
请总结以下文档的核心要点（3-5 条）：

{clipboard}
```

#### 导入/导出模板
- **导出**：点击「导出」保存为 JSON 文件，可分享给他人
- **导入**：点击「导入」加载 JSON 文件，快速添加模板库

## 项目结构

```
AIHub-Windows/
├── main.js           # 主进程
├── preload.js        # 预加载脚本（IPC 桥接）
├── package.json      # 项目配置
├── src/
│   ├── index.html    # 主窗口
│   ├── styles.css    # 样式
│   └── renderer.js   # 渲染进程逻辑
├── scripts/          # 提取/注入脚本
│   ├── extract-chatgpt.js
│   ├── extract-claude.js
│   ├── extract-gemini.js
│   ├── extract-qwen.js
│   ├── extract-deepseek.js
│   ├── extract-doubao.js
│   └── inject-context.js
└── resources/
    └── ai-providers.json  # AI 平台配置
```

## 技术栈

- [Electron](https://www.electronjs.org/) - 跨平台桌面应用框架
- [electron-store](https://github.com/sindresorhus/electron-store) - 本地数据存储
- [electron-builder](https://www.electron.build/) - 应用打包工具

## ❓ 常见问题

### Q1: Windows 安装后无法提取内容怎么办？

**A:** v1.1.0 版本已修复此问题。如果仍有问题：
1. ✅ 确保页面**完全加载**（看到对话内容）
2. ✅ 刷新页面后重试
3. ✅ 检查是否有弹窗错误提示（提供详细原因）
4. ✅ 打开开发者工具（F12）查看控制台错误

### Q2: 豆包/DeepSeek 提取失败，但 Qwen 可以？

**A:** 这正是 v1.1.0 重点修复的问题！
- 🎯 已针对国内 AI 平台优化选择器
- 🔧 增加了多层降级匹配机制
- 📦 更新到最新版本即可解决

**升级方法**：
- 如果是安装包：下载最新版重新安装
- 如果是源码：`git pull` 后重新 `npm install && npm start`

### Q3: 导入功能无响应，输入框没有填充内容？

**A:** 可能原因和解决方案：

| 问题 | 解决方案 |
|------|----------|
| 输入框未加载 | 等待页面完全加载（看到输入框）后再导入 |
| 发送按钮未激活 | v1.1.0 已优化事件触发，更新即可 |
| 特殊字符丢失 | v1.1.0 增强了字符转义，支持所有字符 |
| 页面被冻结 | 刷新页面后重试 |

### Q4: 为什么某个 AI 平台无法正常显示？

**A:** 可能的原因：
- 🌍 **地区限制**：某些平台限制访问（如 ChatGPT 在部分地区）
- 🔐 **需要登录**：首次使用需要在应用内登录
- 🚫 **反爬机制**：极少数情况下平台会检测 Electron
- 🌐 **网络问题**：检查网络连接和代理设置

**测试方法**：在普通浏览器中访问该平台 URL，如果能访问则应用也能访问。

### Q5: 提取的内容包含很多 UI 按钮文字怎么办？

**A:** v1.1.0 已优化内容提取逻辑：
- ✅ 自动过滤按钮、工具栏等 UI 元素
- ✅ 智能识别消息内容区域
- ✅ 去重机制避免重复内容

如果仍有问题，可能是页面结构特殊，欢迎提交 Issue 并附上截图。

### Q6: 如何添加新的 AI 平台？

**A:** 按以下步骤操作：

1. **配置平台信息** - 编辑 `resources/ai-providers.json`：
   ```json
   {
     "id": "new-ai",
     "name": "新AI平台",
     "url": "https://example.com",
     "selectors": {
       "container": ".chat-container",
       "user": ".user-message",
       "assistant": ".ai-message"
     }
   }
   ```

2. **创建提取脚本** - 在 `scripts/` 目录创建 `extract-new-ai.js`：
   ```javascript
   (function() {
     const messages = [];
     // 提取逻辑
     return JSON.stringify(messages);
   })();
   ```

3. **测试并提交 PR** - 欢迎分享你的配置！

### Q7: 提示词模板的 `{clipboard}` 变量不生效？

**A:** 确保：
1. ✅ 使用模板**前**先复制内容到剪贴板
2. ✅ 变量格式正确：`{clipboard}`（注意大小写）
3. ✅ Windows 剪贴板权限已授予应用

### Q8: 如何查看详细错误日志？

**A:** 有两种方法：

**方法一**：应用内开发者工具（推荐）
1. 按 `Ctrl+Shift+I`（Windows）打开开发者工具
2. 切换到 **Console** 标签
3. 重现问题，查看红色错误信息

**方法二**：命令行启动
```bash
# 从源码启动会在终端显示日志
npm start
```

### Q9: 压缩功能生成的 JSON 格式不对？

**A:** 这是正常现象：
- 压缩功能生成的是**给 AI 的提示词**，不是直接压缩结果
- 需要将提示词**粘贴到新对话**中，让 AI 执行压缩
- AI 返回的结果才是最终的 JSON 格式摘要

**正确流程**：
```
提取对话 → 生成压缩提示词 → 粘贴到新对话 → AI 返回压缩结果
```

### Q10: 应用启动慢或卡顿？

**A:** 优化建议：
- 🧹 清理浏览器缓存：删除 `AppData/Roaming/AIHub` 缓存文件
- 💾 释放内存：关闭不用的 AI 平台标签页
- 🔄 重启应用：完全退出后重新启动
- ⚡ Windows 优化：关闭不必要的后台程序

## 🐛 故障排除指南

| 症状 | 可能原因 | 解决方案 |
|------|----------|----------|
| 提取返回空白 | 页面未加载完成 | 等待 2-3 秒后重试 |
| 导入无反应 | 输入框选择器失效 | 更新到 v1.1.0 |
| 发送按钮不亮 | 事件未触发 | v1.1.0 已修复，更新即可 |
| 乱码或换行丢失 | 字符转义问题 | v1.1.0 已修复，更新即可 |
| 应用崩溃 | 内存溢出 | 重启应用，避免提取过长对话 |
| 无法登录平台 | 网络或地区限制 | 检查网络和代理设置 |

**仍无法解决？** 请[提交 Issue](../../issues) 并提供：
- Windows 版本
- 错误截图
- 开发者工具的 Console 日志

## 🗺️ 路线图

- [ ] macOS 和 Linux 版本
- [ ] 更多 AI 平台支持（文心一言、讯飞星火等）
- [ ] 对话历史本地存储
- [ ] 自动更新检测
- [ ] 主题切换（亮色/暗色）
- [ ] 快捷键自定义
- [ ] 插件系统

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

### 贡献方式

1. **报告 Bug**：[提交 Issue](../../issues)，请附上错误截图和日志
2. **提出功能建议**：描述你的使用场景和期望功能
3. **提交代码**：
   - Fork 本仓库
   - 创建功能分支：`git checkout -b feature/新功能`
   - 提交代码：`git commit -m "添加某某功能"`
   - 推送分支：`git push origin feature/新功能`
   - 发起 Pull Request

### 开发规范

- 遵循现有代码风格
- 国内平台优先支持和测试
- 提交前测试所有 AI 平台
- PR 说明中注明测试环境（Windows 版本）

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🙏 致谢

- [Electron](https://www.electronjs.org/) - 跨平台框架
- [electron-store](https://github.com/sindresorhus/electron-store) - 数据持久化
- [electron-builder](https://www.electron.build/) - 应用打包

## 📧 联系方式

- **Issues**：[GitHub Issues](../../issues)
- **Discussions**：[GitHub Discussions](../../discussions)

---

**⭐ 如果这个项目对你有帮助，请给个 Star 支持一下！**
